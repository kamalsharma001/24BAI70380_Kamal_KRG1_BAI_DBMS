CREATE TABLE EMPLOYEE(
	EMP_ID INT PRIMARY KEY,
	EMP_NAME VARCHAR(30) NOT NULL,
	DEPARTMENT VARCHAR(30) NOT NULL,
	SALARY INT CHECK(SALARY>0) NOT NULL,
	JOINING_DATE DATE NOT NULL
)

SELECT * FROM EMPLOYEE

INSERT INTO EMPLOYEE 
VALUES(101,'KRRISH','IT',47850,'01-08-2022')

INSERT INTO EMPLOYEE
VALUES(102,'NISHANT','HR',37000,'01-01-2024')

INSERT INTO EMPLOYEE
VALUES(103,'ROHIT','FINANCE',18000,'15-04-2025')

INSERT INTO EMPLOYEE 
VALUES(104,'LAKSHAY','IT',27850,'01-09-2024')

INSERT INTO EMPLOYEE
VALUES(105,'ARYA','HR',28000,'05-11-2021')

INSERT INTO EMPLOYEE
VALUES(106,'HARSH','FINANCE',16000,'21-07-2023')

INSERT INTO EMPLOYEE
VALUES(107,'SHIVAM','IT',24000,'20-11-2020')

INSERT INTO EMPLOYEE
VALUES(108,'MANAV','FINANCE',21700,'14-11-2022')

INSERT INTO EMPLOYEE
VALUES(109,'VIPUL','HR',31700,'10-10-2025')

SELECT * FROM EMPLOYEE

--STEP 1
SELECT DEPARTMENT,AVG(SALARY)::NUMERIC(10,2) AS AVG_SALARY 
FROM EMPLOYEE
GROUP BY DEPARTMENT

--STEP 2
SELECT DEPARTMENT,AVG(SALARY)::NUMERIC(10,2) AS AVG_SALARY 
FROM EMPLOYEE
WHERE SALARY>20000
GROUP BY DEPARTMENT

--STEP 3
SELECT DEPARTMENT,AVG(SALARY)::NUMERIC(10,2) AS AVG_SALARY 
FROM EMPLOYEE
WHERE SALARY>20000
GROUP BY DEPARTMENT
HAVING AVG(SALARY)>30000

--STEP 4
SELECT DEPARTMENT,AVG(SALARY)::NUMERIC(10,2) AS AVG_SALARY 
FROM EMPLOYEE
WHERE SALARY>20000
GROUP BY DEPARTMENT
HAVING AVG(SALARY)>30000
ORDER BY AVG(SALARY) DESC
