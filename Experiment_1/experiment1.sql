CREATE TABLE BOOKS(
BOOK_ID INT PRIMARY KEY,
NAME VARCHAR(20) NOT NULL,
AUTHOR_NAME VARCHAR(20),
BOOK_COUNT INT CHECK(BOOK_COUNT>0) NOT NULL  
)

CREATE TABLE LIBRARY_VISITORS(
USER_ID INT PRIMARY KEY,
NAME VARCHAR(20) NOT NULL,
AGE INT CHECK(AGE>=17) NOT NULL,
EMAIL VARCHAR(30) NOT NULL UNIQUE
)

CREATE TABLE BOOK_ISSUE(
BOOK_ISSUE_ID INT PRIMARY KEY,
USER_ID INT NOT NULL,
BOOK_ID INT NOT NULL,
ISSUE_DATE DATE NOT NULL,
FOREIGN KEY(USER_ID) REFERENCES LIBRARY_VISITORS(USER_ID),
FOREIGN KEY(BOOK_ID) REFERENCES BOOKS(BOOK_ID)
)

--ANOTHER WAY FOR FOREIGN KEY : 
--USER_ID INT NOT NULL REFERENCES BOOKS(BOOK_ID)
--NOT SUPPORTED ON ORACLE
  
INSERT INTO BOOKS VALUES(101,'STAR WARS','DAVID',5)
INSERT INTO BOOKS VALUES(102,'DEMON','JAMES',8)

SELECT * FROM BOOKS

INSERT INTO LIBRARY_VISITORS(USER_ID,NAME,AGE,EMAIL)
VALUES(501,'SHIVAM SINGH',20,'SHIVAM18@GMAIL.COM')

INSERT INTO LIBRARY_VISITORS(USER_ID,NAME,AGE,EMAIL)
VALUES(502,'SAM SHARMA',20,'SAM18@GMAIL.COM')

SELECT * FROM LIBRARY_VISITORS

INSERT INTO BOOK_ISSUE VALUES(10001,501,101,'2026-01-08')
INSERT INTO BOOK_ISSUE VALUES(10002,502,102,'2026-01-09')
  
SELECT * FROM BOOK_ISSUE

UPDATE BOOK_ISSUE
SET ISSUE_DATE='2026-02-09'
WHERE BOOK_ISSUE_ID=10001

SELECT * FROM BOOK_ISSUE

DELETE FROM BOOK_ISSUE WHERE  BOOK_ISSUE_ID=10002

CREATE ROLE LIBRARIAN WITH LOGIN PASSWORD 'PASSWORD'

GRANT SELECT, INSERT, DELETE, UPDATE ON BOOKS TO LIBRARIAN

GRANT SELECT, INSERT, DELETE, UPDATE ON LIBRARY_VISITORS TO LIBRARIAN

GRANT SELECT, INSERT, DELETE, UPDATE ON BOOK_ISSUE TO LIBRARIAN

REVOKE SELECT, INSERT, DELETE, UPDATE ON BOOKS,LIBRARY_VISITORS,BOOK_ISSUE FROM LIBRARIAN
